<header class="header">
  <div class="header-top">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-4 d-none d-md-block">
          <!-- Empty column -->
        </div>
        <div class="col-md-4 header-contact d-none d-md-flex">
          <div class="contact-info">
            <div class="contact-item">
              <i class="fas fa-map-marker-alt"></i>
              <span>Tầng 6, 266 Đội Cấn, Ba Đình, Hà Nội</span>
            </div>
            <span class="contact-separator">|</span>
            <div class="contact-item">
              <i class="fas fa-phone-alt"></i>
              <a href="tel:18006750" class="fone">1800 6750</a>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="search-container d-none d-md-flex">
            <form
              action="/search"
              method="get"
              class="search-form"
              role="search">
              <input
                type="text"
                name="query"
                value=""
                autocomplete="off"
                placeholder="Tìm kiếm..."
                class="search-input" />
              <button type="submit" class="search-button">
                <i class="fas fa-search"></i>
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Display login/register links on mobile -->
  <div class="header-auth-links d-md-none">
    <a href="./DangNhap.html">Đăng nhập</a> /
    <a href="./DangKy.html">Đăng ký</a>
  </div>

  <div class="header-main">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-12 position-relative">
          <div class="mobile-menu-toggle d-lg-none">
            <a href="#" class="menu-toggle">
              <span></span>
              <span></span>
              <span></span>
            </a>
          </div>

          <div class="logo-header">
            <a href="./index.html" class="logo" title="Logo">
              <img
                width="195"
                height="77"
                src="//bizweb.dktcdn.net/100/063/369/themes/877483/assets/logo.png?1676015309640"
                alt="SunShine School Theme" />
            </a>
          </div>

          <div class="cart-container d-lg-none">
            <a href="./GioHang.html" class="cart-link" id="cart-icon">
              <i class="fas fa-shopping-cart"></i>
              <span class="cart-count">2</span>
            </a>
          </div>

          <!-- Mobile search form -->
          <div class="search-container d-lg-none d-block">
            <form
              action="/search"
              method="get"
              class="search-form"
              role="search">
              <input
                type="text"
                name="query"
                value=""
                autocomplete="off"
                placeholder="Tìm kiếm..."
                class="search-input" />
              <button type="submit" class="search-button">
                <i class="fas fa-search"></i>
              </button>
            </form>
          </div>

          <nav class="main-navigation d-none d-lg-flex">
            <ul class="main-menu">
              <li class="nav-item">
                <a class="nav-link" href="./index.html">
                  <img
                    src="https://bizweb.dktcdn.net/100/063/369/themes/877483/assets/home_icon.jpg"
                    alt="Home"
                    class="home-icon" />
                  Trang chủ
                </a>
              </li>
              <li class="nav-item has-dropdown">
                <a class="nav-link" href="./SanPham.html"
                  >Sản phẩm <i class="fas fa-chevron-down"></i
                ></a>
                <ul class="dropdown-menu">
                  <li><a href="./SanPham.html">Tất cả sản phẩm</a></li>
                  <li>
                    <a href="./SanPham.html?category=Giá trị cho bé"
                      >Giá trị cho bé</a
                    >
                  </li>
                  <li>
                    <a href="./SanPham.html?category=Chương trình học"
                      >Chương trình học</a
                    >
                  </li>
                  <li>
                    <a href="./SanPham.html?category=Chương trình học nổi bật"
                      >Chương trình học nổi bật</a
                    >
                  </li>
                  <li>
                    <a
                      href="./SanPham.html?category=Chương trình học khuyến mãi"
                      >Chương trình học khuyến mãi</a
                    >
                  </li>
                  <li>
                    <a href="./SanPham.html?category=Chương trình học mới"
                      >Chương trình học mới</a
                    >
                  </li>
                </ul>
              </li>
              <li class="nav-item has-dropdown">
                <a class="nav-link" href="./ChuongTrinhGiaoDuc.html"
                  >Chương trình giáo dục <i class="fas fa-chevron-down"></i
                ></a>
                <ul class="dropdown-menu">
                  <li><a href="./GiaTriChoBe.html">Giá trị cho bé</a></li>
                  <li>
                    <a href="./ChuongTrinhGiaoDuc.html">Chương trình học</a>
                  </li>
                </ul>
              </li>
              <li class="nav-item has-dropdown">
                <a class="nav-link" href="./ChuongTrinhHoc.html"
                  >Tuyển sinh <i class="fas fa-chevron-down"></i
                ></a>
                <ul class="dropdown-menu">
                  <li>
                    <a href="./ChuongTrinhHoc.html">Chương trình học</a>
                  </li>
                  <li><a href="./HocPhi.html">Học phí</a></li>
                  <li><a href="./ThucDon.html">Thực đơn</a></li>
                </ul>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="./TinTuc.html">Tin tức</a>
              </li>
              <li class="nav-item has-dropdown">
                <a class="nav-link" href="./GioiThieu.html"
                  >Giới thiệu <i class="fas fa-chevron-down"></i
                ></a>
                <ul class="dropdown-menu">
                  <li><a href="./GioiThieu.html">Về chúng tôi</a></li>
                  <li><a href="./CoSoVatChat.html">Cơ sở vật chất</a></li>
                </ul>
              </li>
            </ul>
          </nav>

          <div class="cart-container d-none d-lg-flex">
            <a href="./GioHang.html" class="cart-link" id="cart-icon">
              <i class="fas fa-shopping-cart"></i>
              <span class="cart-count">0</span>
            </a>
            <div class="cart-dropdown">
              <div class="empty-cart">
                <i class="fas fa-shopping-cart"></i>
                <p>Không có sản phẩm nào trong giỏ hàng của bạn</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>

<style>
  /* Cart styles */
  .cart-container {
    position: relative;
    display: inline-block;
    margin-left: 20px;
  }

  .cart-link {
    position: relative;
    color: #333;
    font-size: 20px;
    display: inline-block;
    padding: 5px;
    transition: all 0.3s ease;
  }

  .cart-link:hover {
    color: #f6903d;
  }

  .cart-link.active i,
  .cart-link i.active {
    color: #f6903d !important;
  }

  .cart-count {
    position: absolute;
    top: -8px;
    right: -8px;
    background-color: #f6903d;
    color: white;
    font-size: 12px;
    font-weight: bold;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Auth links styling */
  .header-auth-links {
    text-align: right;
    padding: 5px 15px;
    font-size: 14px;
  }

  .header-auth-links a {
    color: #f6903d;
    text-decoration: none;
    font-weight: 500;
  }

  .header-auth-links .cart-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background-color: #f6903d;
    color: white;
    border-radius: 50%;
    width: 18px;
    height: 18px;
    font-size: 12px;
    margin-left: 5px;
    vertical-align: middle;
  }

  .cart-dropdown {
    position: absolute;
    top: 100%;
    right: 0;
    width: 300px;
    background: white;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    border-radius: 8px;
    padding: 15px;
    z-index: 1000;
    display: none;
  }

  .cart-container:hover .cart-dropdown {
    display: block;
  }

  .empty-cart {
    text-align: center;
    padding: 20px 0;
  }

  .empty-cart i {
    font-size: 36px;
    color: #ddd;
    margin-bottom: 10px;
  }

  .empty-cart p {
    color: #666;
    margin: 0;
    font-size: 14px;
  }

  /* Mobile menu styles */
  .mobile-nav-container {
    margin: 15px 0;
    background: #fff;
    border-radius: 6px;
    overflow: hidden;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    border: 1px solid #f2f2f2;
  }

  .mobile-nav-item {
    border-bottom: 1px solid #eee;
    position: relative;
  }

  .mobile-nav-item:last-child {
    border-bottom: none;
  }

  .mobile-nav-item a {
    padding: 15px;
    display: block;
    color: #333;
    text-decoration: none;
    font-weight: normal;
  }

  .mobile-nav-item .toggle-submenu {
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    font-size: 16px;
    color: #f6903d;
  }

  .mobile-nav-subitem {
    background: #f9f9f9;
    border-top: 1px solid #eee;
  }

  .mobile-nav-subitem a {
    padding: 12px 15px 12px 30px;
    font-size: 14px;
    font-weight: normal;
  }

  .business-hours {
    margin: 15px;
    color: #f6903d;
  }

  .business-hours .title {
    font-weight: bold;
    margin-bottom: 5px;
  }

  .registration-button {
    text-align: center;
    margin: 15px;
  }

  .registration-button a {
    display: inline-block;
    background: #f6903d;
    color: white;
    padding: 8px 15px;
    border-radius: 5px;
    text-decoration: none;
    font-weight: bold;
    font-size: 14px;
  }

  @media (max-width: 991px) {
    .position-relative {
      position: relative;
    }

    .cart-container {
      position: absolute;
      top: 40px;
      right: 15px;
      margin: 0;
    }

    .mobile-menu-list .menu-item.active > .submenu {
      display: block;
    }

    .mobile-menu-toggle .menu-toggle span {
      background-color: #f6903d;
    }

    .menu-item .fa-plus,
    .menu-item .fa-minus {
      font-size: 12px;
      color: #f6903d;
    }

    /* Main navigation mobile styles */
    .main-navigation.current {
      display: block !important;
      border: 1px solid #f6903d;
      position: absolute;
      top: 115px !important;
      width: fit-content;
      min-width: 200px;
      max-width: 96%;
      left: 2%;
      right: auto;
      background-color: #fff;
      z-index: 99999;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      height: fit-content;
    }

    .main-navigation .main-menu {
      display: block;
      padding: 0;
      margin: 0;
      list-style: none;
    }

    .main-navigation .nav-item {
      border-bottom: 1px solid #eee;
      margin: 0;
      display: block;
    }

    .main-navigation .nav-item:last-child {
      border-bottom: none;
    }

    .main-navigation .nav-link {
      display: block;
      padding: 12px 15px;
      color: #333;
      text-decoration: none;
      font-size: 14px;
    }

    .main-navigation .dropdown-menu {
      position: static !important;
      width: 100% !important;
      border: none !important;
      box-shadow: none !important;
      border-radius: 0 !important;
      background-color: #f9f9f9 !important;
      margin: 0 !important;
      padding: 0 !important;
      visibility: visible !important;
      opacity: 1 !important;
      transform: none !important;
      display: none;
    }

    /* Remove hover effects for mobile */
    .main-navigation .nav-item:hover .dropdown-menu {
      display: none;
    }

    .main-navigation .nav-item.active .dropdown-menu {
      display: block !important;
    }

    .main-navigation .dropdown-menu li {
      border-top: 1px solid #eee;
      border-bottom: none !important;
    }

    .main-navigation .dropdown-menu li a {
      padding: 10px 15px 10px 25px !important;
      font-size: 13px !important;
      border-left: none !important;
    }

    .main-navigation .fa-chevron-down,
    .main-navigation .fa-chevron-up {
      margin-left: 5px;
      font-size: 12px;
      color: #f6903d;
    }

    /* Additional mobile navigation fixes */
    .main-navigation {
      width: auto;
    }

    .main-navigation.main-navigation-mobile {
      display: none;
    }

    .main-navigation .home-icon {
      width: 16px;
      height: auto;
      margin-right: 5px;
      vertical-align: middle;
    }

    /* Adjust container width for better fit */
    .main-navigation.current .main-menu {
      min-width: 220px;
      width: fit-content;
      display: block;
    }

    /* Fix menu width to match content */
    .main-navigation.current {
      width: fit-content !important;
    }
  }
</style>

<!-- Additional CSS for mobile menu -->
<style>
  @media (max-width: 991px) {
    .mobile-menu-toggle .menu-toggle span {
      background-color: #f6903d;
    }

    /* Improve mobile dropdown display */
    .main-navigation .nav-item.has-dropdown .dropdown-menu {
      display: none !important;
    }

    .main-navigation .nav-item.has-dropdown.active .dropdown-menu {
      display: block !important;
    }

    /* Ensure menu width matches content */
    .main-navigation.current {
      width: max-content !important;
    }

    /* Add left border to dropdowns to match design */
    .main-navigation .dropdown-menu li a {
      border-left: 3px solid #f6903d !important;
    }

    /* Force submenu styling */
    .main-navigation .dropdown-menu {
      background-color: #f9f9f9 !important;
      border: none !important;
      box-shadow: none !important;
      position: static !important;
      width: 100% !important;
      margin: 0 !important;
      padding: 0 !important;
    }
  }
</style>

<!-- EMERGENCY DIRECT INLINE SCRIPT - FINAL FIX -->
<script>
  // Execute immediately
  (function () {
    // Function to handle dropdowns
    function setupMobileMenu() {
      console.log("FIXED MOBILE MENU: Setting up mobile menu");

      // Toggle hamburger menu
      var menuToggle = document.querySelector(".menu-toggle");
      if (menuToggle) {
        menuToggle.onclick = function (e) {
          e.preventDefault();
          var nav = document.querySelector(".main-navigation");
          if (nav) {
            nav.classList.toggle("current");
            nav.style.display = nav.classList.contains("current")
              ? "block"
              : "none";
          }
          return false;
        };
      }

      // Only run for mobile and tablet devices
      if (window.innerWidth <= 991) {
        // Reset all dropdowns first
        resetAllDropdowns();

        // Setup all dropdown items
        var dropdowns = document.querySelectorAll(
          ".nav-item.has-dropdown > .nav-link"
        );
        for (var i = 0; i < dropdowns.length; i++) {
          var link = dropdowns[i];

          // Remove any existing icon
          var oldIcon = link.querySelector("i.fas");
          if (oldIcon) {
            oldIcon.remove();
          }

          // Add chevron-down icon
          var icon = document.createElement("i");
          icon.className = "fas fa-chevron-down";
          link.appendChild(icon);

          // Style for mobile
          icon.style.position = "absolute";
          icon.style.right = "15px";
          icon.style.top = "50%";
          icon.style.transform = "translateY(-50%)";
          icon.style.fontSize = "12px";
          icon.style.color = "#f6903d";

          link.style.position = "relative";
          link.style.paddingRight = "30px";

          // Set onclick directly in the HTML attribute for maximum compatibility
          link.setAttribute(
            "onclick",
            "if(window.innerWidth <= 991) { " +
              "  event.preventDefault(); " +
              "  event.stopPropagation(); " +
              "  var parent = this.parentNode; " +
              "  var submenu = parent.querySelector('.dropdown-menu'); " +
              "  var icon = this.querySelector('i.fas'); " +
              "  " +
              "  // Close any other open dropdowns first " +
              "  var allDropdowns = document.querySelectorAll('.nav-item.has-dropdown'); " +
              "  for (var i = 0; i < allDropdowns.length; i++) { " +
              "    var item = allDropdowns[i]; " +
              "    if (item !== parent && item.classList.contains('active')) { " +
              "      item.classList.remove('active'); " +
              "      var itemSubmenu = item.querySelector('.dropdown-menu'); " +
              "      if (itemSubmenu) itemSubmenu.style.display = 'none'; " +
              "      var itemIcon = item.querySelector('.nav-link i.fas'); " +
              "      if (itemIcon) { itemIcon.className = 'fas fa-chevron-down'; itemIcon.style.transform = 'translateY(-50%)'; } " +
              "    } " +
              "  } " +
              "  " +
              "  // Toggle current dropdown " +
              "  if(submenu) { " +
              "    if(submenu.style.display === 'block') { " +
              "      submenu.style.display = 'none'; " +
              "      parent.classList.remove('active'); " +
              "      if(icon) { icon.className = 'fas fa-chevron-down'; icon.style.transform = 'translateY(-50%)'; } " +
              "    } else { " +
              "      submenu.style.display = 'block'; " +
              "      parent.classList.add('active'); " +
              "      if(icon) { icon.className = 'fas fa-chevron-up'; icon.style.transform = 'translateY(-50%)'; } " +
              "    } " +
              "  } " +
              "  return false; " +
              "}"
          );

          // Initialize submenu state
          var parent = link.parentNode;
          var submenu = parent.querySelector(".dropdown-menu");
          if (submenu) {
            submenu.style.display = "none";
          }
        }

        // Add document click event to close menu when clicking outside
        document.addEventListener("click", function (e) {
          var mainNav = document.querySelector(".main-navigation.current");
          var menuToggleBtn = document.querySelector(".menu-toggle");

          // Check if menu is open and click is outside menu
          if (
            mainNav &&
            !mainNav.contains(e.target) &&
            !menuToggleBtn.contains(e.target)
          ) {
            mainNav.classList.remove("current");
            mainNav.style.display = "none";

            // Also close any open dropdowns
            resetAllDropdowns();
          }
        });

        // Apply device-specific styles
        applyDeviceSpecificStyles();
      }
    }

    // Function to reset all dropdowns
    function resetAllDropdowns() {
      var allDropdowns = document.querySelectorAll(".nav-item.has-dropdown");
      for (var i = 0; i < allDropdowns.length; i++) {
        var item = allDropdowns[i];
        item.classList.remove("active");
        var submenu = item.querySelector(".dropdown-menu");
        if (submenu) {
          submenu.style.display = "none";
        }
        var icon = item.querySelector(".nav-link i.fas");
        if (icon) {
          icon.className = "fas fa-chevron-down";
          icon.style.transform = "translateY(-50%)";
        }
      }
    }

    // Apply specific positioning based on device
    function applyDeviceSpecificStyles() {
      var mainNav = document.querySelector(".main-navigation");

      if (!mainNav) return;

      if (window.innerWidth >= 768 && window.innerWidth <= 991) {
        // iPad
        mainNav.style.top = "100px";
        mainNav.style.width = "320px";
        mainNav.style.left = "20px";
      } else if (window.innerWidth >= 576 && window.innerWidth < 768) {
        // Large mobile
        mainNav.style.top = "90px";
        mainNav.style.width = "90%";
        mainNav.style.left = "5%";
      } else if (window.innerWidth < 576) {
        // Small mobile
        mainNav.style.top = "110px";
        mainNav.style.width = "90%";
        mainNav.style.left = "5%";
      }
    }

    // Run on page load
    setupMobileMenu();

    // Run on DOM ready
    document.addEventListener("DOMContentLoaded", setupMobileMenu);

    // Run on window load
    window.addEventListener("load", setupMobileMenu);

    // Run on resize
    window.addEventListener("resize", function () {
      if (window.innerWidth <= 991) {
        setupMobileMenu();
        applyDeviceSpecificStyles();
      }
    });

    // Run after a delay to catch any late-loading elements
    setTimeout(setupMobileMenu, 500);
    setTimeout(setupMobileMenu, 1000);
  })();
</script>

<!-- Mobile Menu Script -->
<script src="./assets/js/mobile-menu.js"></script>
