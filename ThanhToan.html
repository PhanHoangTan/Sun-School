<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Thanh toán - SunShine School</title>

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />

    <!-- Custom CSS - loaded after Bootstrap to override its styles -->
    <link rel="stylesheet" href="./assets/css/style.css" />
    <link rel="stylesheet" href="./assets/css/header.css" />
    <link rel="stylesheet" href="./assets/css/facilities.css" />
    <link rel="stylesheet" href="./assets/css/blog.css" />
    <link rel="stylesheet" href="./assets/css/kinh-nghiem-hay.css" />
    <link rel="stylesheet" href="./assets/css/brand-partners.css" />
    <link rel="stylesheet" href="./assets/css/footer.css" />
    <link rel="stylesheet" href="./assets/css/scroll-top.css" />
    <link rel="stylesheet" href="./assets/css/breadcrumb.css" />
    <link rel="stylesheet" href="./assets/css/checkout.css" />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Lobster&display=swap"
      rel="stylesheet" />
    <!-- Swiper Slider CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/swiper@6.8.4/swiper-bundle.min.css" />
    <!-- Testimonial CSS -->
    <link rel="stylesheet" href="./assets/css/testimonials.css" />
    <!-- Services CSS -->
    <link rel="stylesheet" href="./assets/css/services.css" />

    <!-- Override Bootstrap breadcrumb styles with our custom styles -->
       <style>
            
      /* Brand Partners Mobile Responsive */
      @media (max-width: 575.98px) {
        .section_brand {
          padding: 20px 0 !important;
        }
        
        .section_brand .container {
          padding: 0 15px !important;
          max-width: 100% !important;
        }
        
        .brand-swiper {
          height: 80px !important;
          overflow: visible !important;
        }
        
        .brand-swiper .swiper-slide {
          height: 70px !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
        }
        
        .brand-swiper .swiper-slide img {
          height: 60px !important;
          max-width: 100px !important;
          object-fit: contain !important;
          width: auto !important;
        }
        
        .swiper-button-next,
        .swiper-button-prev {
          width: 44px !important;
          height: 44px !important;
          margin-top: -22px !important;
        }
        
        .swiper-button-next {
          right: 10px !important;
        }
        
        .swiper-button-prev {
          left: 10px !important;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header Component -->
    <!-- Content of the header is in forms/components/header.html -->
    <div id="header-container"></div>

    <main>
      <!-- Breadcrumb Section -->
      <section class="bread-crumb">
        <div class="container">
          <div class="breadcrumb-wrapper">
            <div class="breadcrumb-content">
              <ul class="breadcrumb">
                <li class="home">
                  <a href="/">Trang chủ</a>
                  <i class="fa-solid fa-chevron-right"></i>
                </li>
                <li>
                  <span>Thanh Toán</span>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <!-- About Content Section -->
      <section class="page">
        <div class="container">
          <form
            id="checkoutForm"
            method="post"
            data-define="{
            loadingShippingErrorMessage: 'Không thể load phí vận chuyển. Vui lòng thử lại',
            loadingReductionCodeErrorMessage: 'Có lỗi xảy ra khi áp dụng khuyến mãi. Vui lòng thử lại',
            submitingCheckoutErrorMessage: 'Có lỗi xảy ra khi xử lý. Vui lòng thử lại',
            requireShipping: true,
            requireDistrict: false,
            requireWard: false,
            shouldSaveCheckoutAbandon: true}"
            action="/checkout"
            data-bind-event-submit="handleCheckoutSubmit(event)"
            data-bind-event-keypress="handleCheckoutKeyPress(event)"
            data-bind-event-change="handleCheckoutChange(event)">
            <input type="hidden" name="_method" value="patch" />
            <div class="wrap">
              <main class="main">
                <header class="main__header">
                  <div class="logo logo--left">
                    <h1 class="shop__name">
                      <a href="/">SunShine School Theme</a>
                    </h1>
                  </div>
                </header>
                <div class="main__content">
                  <article class="animate-floating-labels row">
                    <div class="col col--two">
                      <section class="section">
                        <div class="section__header">
                          <div class="layout-flex">
                            <h2
                              class="section__title layout-flex__item layout-flex__item--stretch">
                              <i
                                class="fa fa-id-card-o fa-lg section__title--icon hide-on-desktop"></i>
                              Thông tin nhận hàng
                            </h2>
                            <a href="./DangNhap.html">
                              <i class="fa fa-user-circle-o fa-lg"></i>
                              <span>Đăng nhập </span>
                            </a>
                          </div>
                        </div>
                        <div class="section__content">
                          <div class="fieldset">
                            <div
                              class="field"
                              data-bind-class="{'field--show-floating-label': email}">
                              <div class="field__input-wrapper">
                                <label for="email" class="field__label">
                                  Email
                                </label>
                                <input
                                  name="email"
                                  id="email"
                                  type="email"
                                  class="field__input"
                                  data-bind="email"
                                  value="" />
                              </div>
                            </div>

                            <div
                              class="field"
                              data-bind-class="{'field--show-floating-label': billing.name}">
                              <div class="field__input-wrapper">
                                <label for="billingName" class="field__label"
                                  >Họ và tên</label
                                >
                                <input
                                  name="billingName"
                                  id="billingName"
                                  type="text"
                                  class="field__input"
                                  data-bind="billing.name"
                                  value="" />
                              </div>
                            </div>

                            <div
                              class="field"
                              data-bind-class="{'field--show-floating-label': billing.phone}">
                              <div
                                class="field__input-wrapper field__input-wrapper--connected"
                                data-define="{phoneInput: new InputPhone(this)}">
                                <label for="billingPhone" class="field__label">
                                  Số điện thoại (tùy chọn)
                                </label>
                                <input
                                  name="billingPhone"
                                  id="billingPhone"
                                  type="tel"
                                  class="field__input"
                                  data-bind="billing.phone"
                                  value="" />
                                <div class="field__input-phone-region-wrapper">
                                  <select
                                    class="field__input select-phone-region"
                                    name="billingPhoneRegion"
                                    data-init-value="VN">
                                    <option value="VN" selected>
                                      Vietnam (+84)
                                    </option>
                                  </select>
                                </div>
                              </div>
                            </div>

                            <div
                              class="field"
                              data-bind-class="{'field--show-floating-label': billing.address}">
                              <div class="field__input-wrapper">
                                <label
                                  for="billingAddress"
                                  class="field__label">
                                  Địa chỉ (tùy chọn)
                                </label>
                                <input
                                  name="billingAddress"
                                  id="billingAddress"
                                  type="text"
                                  class="field__input"
                                  data-bind="billing.address"
                                  value="" />
                              </div>
                            </div>

                            <div class="field field--show-floating-label">
                              <div
                                class="field__input-wrapper field__input-wrapper--select2">
                                <label
                                  for="billingProvince"
                                  class="field__label"
                                  >Tỉnh thành</label
                                >
                                <select
                                  name="billingProvince"
                                  id="billingProvince"
                                  size="1"
                                  class="field__input field__input--select"
                                  data-bind="billing.province"
                                  value=""
                                  data-address-type="province"
                                  data-address-zone="billing">
                                  <option value="" hidden>---</option>
                                  <!-- Options will be loaded dynamically from JSON -->
                                </select>
                              </div>
                            </div>

                            <div class="field field--show-floating-label">
                              <div
                                class="field__input-wrapper field__input-wrapper--select2">
                                <label
                                  for="billingDistrict"
                                  class="field__label">
                                  Quận huyện (tùy chọn)
                                </label>
                                <select
                                  name="billingDistrict"
                                  id="billingDistrict"
                                  size="1"
                                  class="field__input field__input--select"
                                  value=""
                                  data-bind="billing.district"
                                  data-address-type="district"
                                  data-address-zone="billing"
                                  disabled="disabled">
                                  <!-- Options will be loaded dynamically based on province selection -->
                                </select>
                              </div>
                            </div>

                            <div class="field field--show-floating-label">
                              <div
                                class="field__input-wrapper field__input-wrapper--select2">
                                <label for="billingWard" class="field__label">
                                  Phường/Xã (tùy chọn)
                                </label>
                                <select
                                  name="billingWard"
                                  id="billingWard"
                                  size="1"
                                  class="field__input field__input--select"
                                  value=""
                                  data-bind="billing.ward"
                                  data-address-type="ward"
                                  data-address-zone="billing"
                                  disabled="disabled">
                                  <!-- Options will be loaded dynamically based on district selection -->
                                </select>
                              </div>
                            </div>
                          </div>
                        </div>
                      </section>

                      <div class="fieldset">
                        <h3 class="visually-hidden">Ghi chú</h3>
                        <div
                          class="field"
                          data-bind-class="{'field--show-floating-label': note}">
                          <div class="field__input-wrapper">
                            <label for="note" class="field__label">
                              Ghi chú (tùy chọn)
                            </label>
                            <textarea
                              name="note"
                              id="note"
                              class="field__input"
                              data-bind="note"></textarea>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="col col--two">
                      <section
                        class="section"
                        data-define="{shippingMethod: ''}">
                        <div class="section__header">
                          <div class="layout-flex">
                            <h2
                              class="section__title layout-flex__item layout-flex__item--stretch">
                              <i
                                class="fa fa-truck fa-lg section__title--icon hide-on-desktop"></i>
                              Vận chuyển
                            </h2>
                          </div>
                        </div>
                        <div
                          class="section__content"
                          data-tg-refresh="refreshShipping"
                          id="shippingMethodList"
                          data-define="{isAddressSelecting: true, shippingMethods: []}">
                          <div
                            class="alert alert--loader spinner spinner--active hide"
                            data-bind-show="isLoadingShippingMethod">
                            <svg
                              xmlns="http://www.w3.org/2000/svg"
                              class="spinner-loader">
                              <use href="#spinner"></use>
                            </svg>
                          </div>

                          <div
                            class="alert alert--info"
                            id="shipping-info-alert"
                            style="display: block">
                            Vui lòng nhập thông tin giao hàng
                          </div>

                          <div id="shipping-methods" style="display: none">
                            <div class="content-box">
                              <div class="content-box__row">
                                <div class="radio-wrapper">
                                  <div class="radio__input">
                                    <input
                                      name="shippingMethod"
                                      id="shippingMethod-standard"
                                      type="radio"
                                      class="input-radio"
                                      value="standard"
                                      checked />
                                  </div>
                                  <label
                                    for="shippingMethod-standard"
                                    class="radio__label">
                                    <span class="radio__label__primary">
                                      Giao hàng tiêu chuẩn
                                    </span>
                                    <span class="radio__label__accessory">
                                      <span class="radio__label__price"
                                        >40.000₫</span
                                      >
                                    </span>
                                  </label>
                                </div>
                                <div class="content-box__row__desc">
                                  <p>Giao hàng trong 2-3 ngày làm việc</p>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </section>

                      <section class="section">
                        <div class="section__header">
                          <div class="layout-flex">
                            <h2
                              class="section__title layout-flex__item layout-flex__item--stretch">
                              <i
                                class="fa fa-credit-card fa-lg section__title--icon hide-on-desktop"></i>
                              Thanh toán
                            </h2>
                          </div>
                        </div>
                        <div class="section__content">
                          <div
                            class="content-box"
                            data-define="{paymentMethod: undefined}">
                            <div class="content-box__row">
                              <div class="radio-wrapper">
                                <div class="radio__input">
                                  <input
                                    name="paymentMethod"
                                    id="paymentMethod-65992"
                                    type="radio"
                                    class="input-radio"
                                    data-bind="paymentMethod"
                                    value="65992"
                                    data-provider-id="4"
                                    checked />
                                </div>
                                <label
                                  for="paymentMethod-65992"
                                  class="radio__label">
                                  <span class="radio__label__primary"
                                    >Thanh toán khi giao hàng (COD)</span
                                  >
                                  <span class="radio__label__accessory">
                                    <span class="radio__label__icon">
                                      <i
                                        class="payment-icon payment-icon--4"></i>
                                    </span>
                                  </span>
                                </label>
                              </div>

                              <div
                                class="content-box__row__desc"
                                data-bind-show="paymentMethod == 65992"
                                data-provider-id="4">
                                <p>
                                  Bạn chỉ phải thanh toán khi nhận được hàng
                                </p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </section>
                    </div>
                  </article>
                  <div
                    class="field__input-btn-wrapper field__input-btn-wrapper--vertical hide-on-desktop">
                    <button
                      type="submit"
                      class="btn btn-checkout spinner"
                      data-bind-class="{'spinner--active': isSubmitingCheckout}"
                      data-bind-disabled="isSubmitingCheckout || isLoadingReductionCode">
                      <span class="spinner-label">ĐẶT HÀNG</span>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        class="spinner-loader">
                        <use href="#spinner"></use>
                      </svg>
                    </button>

                    <a href="./GioHang.html" class="previous-link">
                      <i class="previous-link__arrow">❮</i>
                      <span class="previous-link__content"
                        >Quay về giỏ hàng</span
                      >
                    </a>
                  </div>

                  <div id="common-alert" data-tg-refresh="refreshError">
                    <div
                      class="alert alert--danger hide-on-desktop hide"
                      data-bind-show="!isSubmitingCheckout && isSubmitingCheckoutError"
                      data-bind="submitingCheckoutErrorMessage">
                      Có lỗi xảy ra khi xử lý. Vui lòng thử lại
                    </div>
                  </div>
                </div>
              </main>
              <aside class="sidebar">
                <div class="sidebar__header">
                  <h2 class="sidebar__title">
                    Đơn hàng (<span id="cart-item-count">0</span> sản phẩm)
                  </h2>
                </div>
                <div class="sidebar__content">
                  <div
                    id="order-summary"
                    class="order-summary order-summary--is-collapsed">
                    <div class="order-summary__sections">
                      <div
                        class="order-summary__section order-summary__section--product-list order-summary__section--is-scrollable order-summary--collapse-element">
                        <table
                          class="product-table"
                          id="product-table"
                          data-tg-refresh="refreshDiscount">
                          <caption class="visually-hidden">
                            Chi tiết đơn hàng
                          </caption>
                          <thead class="product-table__header">
                            <tr>
                              <th>
                                <span class="visually-hidden"
                                  >Ảnh sản phẩm</span
                                >
                              </th>
                              <th>
                                <span class="visually-hidden">Mô tả</span>
                              </th>
                              <th>
                                <span class="visually-hidden">Số lượng</span>
                              </th>
                              <th>
                                <span class="visually-hidden">Đơn giá</span>
                              </th>
                            </tr>
                          </thead>
                          <tbody id="checkout-cart-items">
                            <!-- Cart items will be populated here -->
                          </tbody>
                        </table>
                      </div>
                      <div
                        class="order-summary__section order-summary__section--discount-code"
                        data-tg-refresh="refreshDiscount"
                        id="discountCode">
                        <h3 class="visually-hidden">Mã khuyến mại</h3>
                        <div class="edit_checkout animate-floating-labels">
                          <div class="fieldset">
                            <div class="field">
                              <div class="field__input-btn-wrapper">
                                <div class="field__input-wrapper">
                                  <label
                                    for="reductionCode"
                                    class="field__label"
                                    >Nhập mã giảm giá</label
                                  >
                                  <input
                                    name="reductionCode"
                                    id="reductionCode"
                                    type="text"
                                    class="field__input"
                                    autocomplete="off"
                                    data-bind-disabled="isLoadingReductionCode"
                                    data-bind-event-keypress="handleReductionCodeKeyPress(event)"
                                    data-define="{reductionCode: null}"
                                    data-bind="reductionCode" />
                                </div>
                                <button
                                  class="field__input-btn btn spinner btn--disabled"
                                  type="button"
                                  data-bind-disabled="isLoadingReductionCode || !reductionCode"
                                  data-bind-class="{'spinner--active': isLoadingReductionCode, 'btn--disabled': !reductionCode}"
                                  data-bind-event-click="applyReductionCode()"
                                  disabled="">
                                  <span class="spinner-label">Áp dụng</span>
                                  <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="spinner-loader">
                                    <use href="#spinner"></use>
                                  </svg>
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div
                        class="order-summary__section order-summary__section--total-lines order-summary--collapse-element"
                        data-define="{subTotalPriceText: '0₫'}"
                        data-tg-refresh="refreshOrderTotalPrice"
                        id="orderSummary">
                        <table class="total-line-table">
                          <caption class="visually-hidden">
                            Tổng giá trị
                          </caption>
                          <thead>
                            <tr>
                              <td>
                                <span class="visually-hidden">Mô tả</span>
                              </td>
                              <td>
                                <span class="visually-hidden">Giá tiền</span>
                              </td>
                            </tr>
                          </thead>
                          <tbody class="total-line-table__tbody">
                            <tr class="total-line total-line--subtotal">
                              <th class="total-line__name">Tạm tính</th>
                              <td class="total-line__price" id="subtotal-price">
                                0₫
                              </td>
                            </tr>

                            <tr class="total-line total-line--shipping-fee">
                              <th class="total-line__name">Phí vận chuyển</th>
                              <td class="total-line__price" id="shipping-fee">
                                <span id="shipping-price">-</span>
                              </td>
                            </tr>
                          </tbody>
                          <tfoot class="total-line-table__footer">
                            <tr class="total-line payment-due">
                              <th class="total-line__name">
                                <span class="payment-due__label-total">
                                  Tổng cộng
                                </span>
                              </th>
                              <td class="total-line__price">
                                <span
                                  class="payment-due__price"
                                  id="total-price"
                                  >0₫</span
                                >
                              </td>
                            </tr>
                          </tfoot>
                        </table>
                      </div>
                      <div
                        class="order-summary__nav field__input-btn-wrapper hide-on-mobile layout-flex--row-reverse">
                        <button
                          type="submit"
                          class="btn btn-checkout spinner"
                          data-bind-class="{'spinner--active': isSubmitingCheckout}"
                          data-bind-disabled="isSubmitingCheckout || isLoadingReductionCode">
                          <span class="spinner-label">ĐẶT HÀNG</span>
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="spinner-loader">
                            <use href="#spinner"></use>
                          </svg>
                        </button>

                        <a href="./GioHang.html" class="previous-link">
                          <i class="previous-link__arrow">❮</i>
                          <span class="previous-link__content"
                            >Quay về giỏ hàng</span
                          >
                        </a>
                      </div>
                      <div
                        id="common-alert-sidebar"
                        data-tg-refresh="refreshError">
                        <div
                          class="alert alert--danger hide-on-mobile hide"
                          data-bind-show="!isSubmitingCheckout && isSubmitingCheckoutError"
                          data-bind="submitingCheckoutErrorMessage">
                          Có lỗi xảy ra khi xử lý. Vui lòng thử lại
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </aside>
            </div>
          </form>
        </div>
      </section>

      <!-- Brand Partners Section -->
      <section class="section_brand">
        <div class="container">
          <div class="brand">
            <div
              class="brand-swiper swiper-container swiper-container-initialized swiper-container-horizontal swiper-container-pointer-events"
              style="cursor: grab">
              <div
                class="swiper-wrapper"
                style="transform: translate3d(0px, 0px, 0px)">
                <div
                  class="swiper-slide swiper-slide-active"
                  style="width: 100px; margin-right: 40px">
                  <a href="#" title="Đối tác 1">
                    <img
                      width="100"
                      height="60"
                      src="https://bizweb.dktcdn.net/100/063/369/themes/877483/assets/img_brand_1.jpg?1676015309640"
                      alt="Đối tác 1"
                      class="img-responsive" />
                  </a>
                </div>
                <div
                  class="swiper-slide swiper-slide-next"
                  style="width: 100px; margin-right: 40px">
                  <a href="#" title="Đối tác 2">
                    <img
                      width="100"
                      height="60"
                      src="https://bizweb.dktcdn.net/100/063/369/themes/877483/assets/img_brand_2.jpg?1676015309640"
                      alt="Đối tác 2"
                      class="img-responsive" />
                  </a>
                </div>
                <div
                  class="swiper-slide"
                  style="width: 100px; margin-right: 40px">
                  <a href="#" title="Đối tác 3">
                    <img
                      width="100"
                      height="60"
                      src="https://bizweb.dktcdn.net/100/063/369/themes/877483/assets/img_brand_3.jpg?1676015309640"
                      alt="Đối tác 3"
                      class="img-responsive" />
                  </a>
                </div>
                <div
                  class="swiper-slide"
                  style="width: 100px; margin-right: 40px">
                  <a href="#" title="Đối tác 4">
                    <img
                      width="100"
                      height="60"
                      src="https://bizweb.dktcdn.net/100/063/369/themes/877483/assets/img_brand_4.jpg?1676015309640"
                      alt="Đối tác 4"
                      class="img-responsive" />
                  </a>
                </div>
                <div
                  class="swiper-slide"
                  style="width: 100px; margin-right: 40px">
                  <a href="#" title="Đối tác 5">
                    <img
                      width="100"
                      height="60"
                      src="https://bizweb.dktcdn.net/100/063/369/themes/877483/assets/img_brand_5.jpg?1676015309640"
                      alt="Đối tác 5"
                      class="img-responsive" />
                  </a>
                </div>
                <div
                  class="swiper-slide"
                  style="width: 100px; margin-right: 40px">
                  <a href="#" title="Đối tác 6">
                    <img
                      width="100"
                      height="60"
                      src="https://bizweb.dktcdn.net/100/063/369/themes/877483/assets/img_brand_6.jpg?1676015309640"
                      alt="Đối tác 6"
                      class="img-responsive" />
                  </a>
                </div>
              </div>
            </div>
            <div class="swiper-button-prev"></div>
            <div class="swiper-button-next"></div>
          </div>
        </div>
      </section>
    </main>

    <footer id="footer" class="footer">
      <div class="widget">
        <div class="container">
          <div class="row">
            <div class="col-lg-3 col-md-6 no-padding-l">
              <div class="widget-item">
                <a class="footer-logo" href="#"
                  ><img
                    width="195"
                    height="77"
                    alt="SunShine School Theme"
                    src="https://bizweb.dktcdn.net/100/063/369/themes/877483/assets/logo_white.png"
                /></a>
                <!-- End .widget-title -->
                <div class="widget-menu infomation">
                  <div class="time_work">
                    <div class="item">
                      <svg
                        aria-hidden="true"
                        focusable="false"
                        data-prefix="fas"
                        data-icon="phone-alt"
                        role="img"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 512 512"
                        class="svg-inline--fa fa-phone-alt fa-w-16">
                        <path
                          fill="currentColor"
                          d="M497.39 361.8l-112-48a24 24 0 0 0-28 6.9l-49.6 60.6A370.66 370.66 0 0 1 130.6 204.11l60.6-49.6a23.94 23.94 0 0 0 6.9-28l-48-112A24.16 24.16 0 0 0 122.6.61l-104 24A24 24 0 0 0 0 48c0 256.5 207.9 464 464 464a24 24 0 0 0 23.4-18.6l24-104a24.29 24.29 0 0 0-14.01-27.6z"
                          class=""></path>
                      </svg>
                      <a class="fone" href="tel:18006750">1800 6750</a>
                    </div>
                    <div class="item">
                      <svg
                        aria-hidden="true"
                        focusable="false"
                        data-prefix="fas"
                        data-icon="map-marker-alt"
                        role="img"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 384 512"
                        class="svg-inline--fa fa-map-marker-alt fa-w-12">
                        <path
                          fill="currentColor"
                          d="M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"
                          class=""></path>
                      </svg>
                      <span class="dc">
                        Tầng 6, 266 Đội Cấn, Ba Đình, Hà Nội
                      </span>
                    </div>
                    <div class="item">
                      <svg
                        aria-hidden="true"
                        focusable="false"
                        data-prefix="fas"
                        data-icon="envelope"
                        role="img"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 512 512"
                        class="svg-inline--fa fa-envelope fa-w-16">
                        <path
                          fill="currentColor"
                          d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"
                          class=""></path>
                      </svg>
                      <a href="mailto:support@sapo.vn">support@sapo.vn</a>
                    </div>
                  </div>
                  <div class="social_icon">
                    <ul>
                      <li>
                        <a
                          target="_blank"
                          title="Facebook"
                          href="https://www.facebook.com/"
                          ><svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 320 512">
                            <!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                            <path
                              d="M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"></path></svg
                        ></a>
                      </li>
                      <li>
                        <a
                          target="_blank"
                          title="Linkedin"
                          href="https://www.linkedin.com/"
                          ><svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 448 512">
                            <!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                            <path
                              d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg
                        ></a>
                      </li>
                      <li>
                        <a
                          target="_blank"
                          title="Twitter"
                          href="https://twitter.com/"
                          ><svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 512 512">
                            <!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                            <path
                              d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg
                        ></a>
                      </li>
                    </ul>
                  </div>
                </div>
                <!-- End .widget-menu -->
              </div>
            </div>
            <div class="col-lg-3 col-md-6 no-padding-l">
              <div class="widget-item">
                <h4 class="widget-title">Tin nhà trường</h4>
                <!-- End .widget-title -->
                <ul class="widget-menu">
                  <li><a href="./index.html" class="has_icon">Trang chủ</a></li>
                  <li>
                    <a href="./SanPham.html" class="has_icon">Sản phẩm</a>
                  </li>
                  <li>
                    <a href="./ChuongTrinhGiaoDuc.html" class="has_icon"
                      >Chương trình giáo dục</a
                    >
                  </li>
                  <li>
                    <a href="./ChuongTrinhHoc.html" class="has_icon"
                      >Tuyển sinh</a
                    >
                  </li>
                  <li><a href="./TinTuc.html" class="has_icon">Tin tức</a></li>
                  <li>
                    <a href="./GioiThieu.html" class="has_icon">Giới thiệu</a>
                  </li>
                </ul>
                <!-- End .widget-menu -->
              </div>
              <!-- End .widget-item -->
            </div>

            <div class="col-lg-3 col-md-6 no-padding-l">
              <div class="widget-item">
                <h4 class="widget-title">Kinh nghiệm hay</h4>
                <!-- End .widget-title -->
                <ul class="widget-menu">
                  <li><a href="./index.html" class="has_icon">Trang chủ</a></li>
                  <li>
                    <a href="./SanPham.html" class="has_icon">Sản phẩm</a>
                  </li>
                  <li>
                    <a href="./ChuongTrinhGiaoDuc.html" class="has_icon"
                      >Chương trình giáo dục</a
                    >
                  </li>
                  <li>
                    <a href="./ChuongTrinhHoc.html" class="has_icon"
                      >Tuyển sinh</a
                    >
                  </li>
                  <li><a href="./TinTuc.html" class="has_icon">Tin tức</a></li>
                  <li>
                    <a href="./GioiThieu.html" class="has_icon">Giới thiệu</a>
                  </li>
                </ul>
                <!-- End .widget-menu -->
              </div>
              <!-- End .widget-item -->
            </div>
            <div class="hidden-xs col-lg-3 col-md-6 no-padding-lr">
              <div class="widget-item">
                <h4 class="widget-title">Facebook</h4>
                <!-- End .widget-title -->
                <div
                  class="fb-page fb_iframe_widget"
                  data-href="https://www.facebook.com/sapo.vn/"
                  data-small-header="false"
                  data-adapt-container-width="true"
                  data-hide-cover="false"
                  data-show-facepile="true">
                  <iframe
                    src="https://www.facebook.com/plugins/page.php?href=https%3A%2F%2Fwww.facebook.com%2Fsapo.vn%2F&tabs&width=255&height=130&small_header=false&adapt_container_width=true&hide_cover=false&show_facepile=true"
                    width="255"
                    height="130"
                    style="border: none; overflow: hidden"
                    scrolling="no"
                    frameborder="0"
                    allowfullscreen="true"
                    allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share"></iframe>
                </div>
                <!-- End .widget-menu -->
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- End .widget -->
      <div class="hidden-xs hidden-sm">
        <div class="container">
          <div class="row">
            <div class="col-md-12">
              <div class="plane_fly_lg"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <div class="container">
          <div class="row">
            <div class="col-lg-6 col-md-12 copyright-pr no-padding-r">
              <div
                class="copyright"
                style="white-space: nowrap; display: inline-block">
                © Bản quyền thuộc về <b>Awesome Team</b> | Cung cấp bởi
                <a
                  href="https://www.sapo.vn/"
                  rel="nofollow"
                  title="Sapo"
                  target="_blank"
                  >Sapo</a
                >
              </div>
            </div>
            <div class="col-lg-6 col-md-12 no-padding-l">
              <div class="pull-right">
                <ul class="bottom_linklist">
                  <li>
                    <a href="./index.html" title="Trang chủ">Trang chủ</a>
                  </li>
                  <li>
                    <a href="./SanPham.html" title="Sản phẩm">Sản phẩm</a>
                  </li>
                  <li>
                    <a
                      href="./ChuongTrinhGiaoDuc.html"
                      title="Chương trình giáo dục"
                      >Chương trình giáo dục</a
                    >
                  </li>
                  <li>
                    <a href="./ChuongTrinhHoc.html" title="Tuyển sinh"
                      >Tuyển sinh</a
                    >
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- Scroll to top button -->
    <div id="back-to-top" class="back-to-top">
      <a class="top" href="#" title="Scroll to top">
        <i class="fa fa-angle-up"></i
      ></a>
    </div>

    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js"></script>
    <!-- Swiper JS -->
    <script src="https://unpkg.com/swiper@6.8.4/swiper-bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="./assets/js/main.js"></script>
    <script src="./assets/js/mobile-menu.js"></script>
    <script src="./assets/js/header.js"></script>
    <script src="./assets/js/footer.js"></script>
    <script src="./assets/js/scroll-top.js"></script>
    <script src="./assets/js/brand-partners.js"></script>
    <script src="./assets/js/cart-manager.js"></script>
    <script src="./assets/js/vietnam-address.js"></script>

    <!-- Mobile Menu JavaScript -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Mobile menu dropdown functionality
        const dropdownItems = document.querySelectorAll(
          ".nav-item.has-dropdown"
        );

        dropdownItems.forEach(function (item) {
          const link = item.querySelector(".nav-link");
          const dropdown = item.querySelector(".dropdown-menu");

          if (link && dropdown) {
            // Handle click on mobile
            link.addEventListener("click", function (e) {
              const isMobile = window.innerWidth <= 768;
              if (isMobile) {
                e.preventDefault();
                dropdown.style.display =
                  dropdown.style.display === "block" ? "none" : "block";
              }
            });

            // Handle hover on desktop
            item.addEventListener("mouseenter", function () {
              const isMobile = window.innerWidth <= 768;
              if (!isMobile && dropdown) {
                dropdown.style.display = "block";
                dropdown.style.opacity = "1";
                dropdown.style.visibility = "visible";
              }
            });

            item.addEventListener("mouseleave", function () {
              const isMobile = window.innerWidth <= 768;
              if (!isMobile && dropdown) {
                dropdown.style.opacity = "0";
                dropdown.style.visibility = "hidden";
                setTimeout(() => {
                  dropdown.style.display = "none";
                }, 300);
              }
            });
          }
        });

        // CSS fallback for hover states
        const style = document.createElement("style");
        style.innerHTML = `
          @media (min-width: 769px) {
            .nav-item.has-dropdown:hover .dropdown-menu {
              display: block !important;
              opacity: 1 !important;
              visibility: visible !important;
            }
          }
        `;
        document.head.appendChild(style);
      });
    </script>

    <!-- Script to load header component -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const headerContainer = document.getElementById("header-container");
        if (headerContainer) {
          fetch("./forms/components/header.html")
            .then((response) => response.text())
            .then((data) => {
              headerContainer.innerHTML = data;

              // Set active class for checkout page
              setTimeout(() => {
                const menuItems = document.querySelectorAll(
                  ".main-menu .nav-item"
                );
                menuItems.forEach((item) => item.classList.remove("active"));

                // Checkout page - highlight products menu
                const productsItem = document.querySelector(
                  ".main-menu .nav-item:nth-child(2)"
                );
                if (productsItem) productsItem.classList.add("active");
              }, 100);
            })
            .catch((error) => {
              console.error("Error loading header component:", error);
            });
        }
      });
    </script>

    <script>
      // Checkout page functionality
      document.addEventListener("DOMContentLoaded", function () {
        // Initialize checkout page
        initializeCheckoutPage();

        // Form validation and submission
        const checkoutForm = document.getElementById("checkoutForm");
        if (checkoutForm) {
          checkoutForm.addEventListener("submit", handleCheckoutSubmit);
        }

        // Floating label functionality
        const inputs = document.querySelectorAll(".field__input");
        inputs.forEach((input) => {
          input.addEventListener("focus", handleInputFocus);
          input.addEventListener("blur", handleInputBlur);
          input.addEventListener("input", handleInputChange);

          // Check initial state
          if (input.value) {
            input.closest(".field").classList.add("field--show-floating-label");
          }
        });

        // Monitor address fields for shipping calculation
        const addressFields = [
          "billingProvince",
          "billingDistrict",
          "billingAddress",
        ];

        addressFields.forEach((fieldId) => {
          const field = document.getElementById(fieldId);
          if (field) {
            field.addEventListener("change", checkAddressCompletion);
            field.addEventListener("input", checkAddressCompletion);
          }
        });

        // Province selection handler (removed - now handled by vietnam-address.js)

        // Discount code functionality
        const discountBtn = document.querySelector(".field__input-btn");
        const discountInput = document.getElementById("reductionCode");
        if (discountBtn && discountInput) {
          discountBtn.addEventListener("click", applyDiscountCode);
          discountInput.addEventListener("input", function () {
            if (this.value.trim()) {
              discountBtn.classList.remove("btn--disabled");
              discountBtn.disabled = false;
            } else {
              discountBtn.classList.add("btn--disabled");
              discountBtn.disabled = true;
            }
          });
        }
      });

      function initializeCheckoutPage() {
        // Load cart items from localStorage
        const cartData = localStorage.getItem("sunschool_cart");
        let cart = [];

        try {
          cart = cartData ? JSON.parse(cartData) : [];
        } catch (e) {
          console.error("Error loading cart:", e);
          cart = [];
        }

        // Update cart count in sidebar title
        const cartCountElement = document.getElementById("cart-item-count");
        if (cartCountElement) {
          const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
          cartCountElement.textContent = totalItems;
        }

        // Populate cart items in checkout
        populateCheckoutItems(cart);

        // Calculate and display totals
        calculateTotals(cart);

        // If cart is empty, redirect to cart page
        if (cart.length === 0) {
          alert(
            "Giỏ hàng của bạn đang trống. Vui lòng thêm sản phẩm trước khi thanh toán."
          );
          window.location.href = "./GioHang.html";
          return;
        }
      }

      function populateCheckoutItems(cart) {
        const cartItemsContainer = document.getElementById(
          "checkout-cart-items"
        );
        if (!cartItemsContainer) return;

        if (cart.length === 0) {
          cartItemsContainer.innerHTML = `
            <tr>
              <td colspan="4" style="text-align: center; padding: 40px;">
                <p>Không có sản phẩm nào trong giỏ hàng</p>
              </td>
            </tr>
          `;
          return;
        }

        let itemsHtml = "";
        cart.forEach((item) => {
          // Extract numeric price
          let itemPrice = 0;
          if (item.price && !item.price.includes("Liên hệ")) {
            const priceString = item.price;
            const matches = priceString.match(/[\d,.]+/g);
            if (matches && matches.length > 0) {
              itemPrice = parseFloat(
                matches[0].replace(/\./g, "").replace(/,/g, "")
              );
            }
          }

          const formattedPrice = formatPrice(itemPrice);
          const imageUrl = item.image.startsWith("//")
            ? "https:" + item.image
            : item.image;

          itemsHtml += `
            <tr class="product">
              <td class="product__image">
                <div class="product-thumbnail">
                  <div class="product-thumbnail__wrapper">
                    <img src="${imageUrl}" alt="${item.name}" class="product-thumbnail__image">
                  </div>
                  <span class="product-thumbnail__quantity">${item.quantity}</span>
                </div>
              </td>
              <th class="product__description">
                <span class="product__description__name">
                  ${item.name}
                </span>
              </th>
              <td class="product__quantity visually-hidden"><em>Số lượng:</em> ${item.quantity}</td>
              <td class="product__price">
                ${formattedPrice}
              </td>
            </tr>
          `;
        });

        cartItemsContainer.innerHTML = itemsHtml;
      }

      function calculateTotals(cart) {
        let subtotal = 0;

        cart.forEach((item) => {
          let itemPrice = 0;
          if (item.price && !item.price.includes("Liên hệ")) {
            const priceString = item.price;
            const matches = priceString.match(/[\d,.]+/g);
            if (matches && matches.length > 0) {
              itemPrice = parseFloat(
                matches[0].replace(/\./g, "").replace(/,/g, "")
              );
            }
          }
          subtotal += itemPrice * item.quantity;
        });

        // Update subtotal
        const subtotalElement = document.getElementById("subtotal-price");
        if (subtotalElement) {
          subtotalElement.textContent = formatPrice(subtotal);
        }

        // Get shipping fee
        let shippingFee = 0;
        const shippingPriceElement = document.getElementById("shipping-price");
        if (shippingPriceElement && shippingPriceElement.textContent !== "-") {
          const shippingText = shippingPriceElement.textContent;
          const matches = shippingText.match(/[\d,.]+/g);
          if (matches && matches.length > 0) {
            shippingFee = parseFloat(
              matches[0].replace(/\./g, "").replace(/,/g, "")
            );
          }
        }

        // Calculate total with shipping
        const total = subtotal + shippingFee;

        // Update total
        const totalElement = document.getElementById("total-price");
        if (totalElement) {
          totalElement.textContent = formatPrice(total);
        }
      }

      function formatPrice(price) {
        return new Intl.NumberFormat("vi-VN", {
          style: "currency",
          currency: "VND",
          minimumFractionDigits: 0,
          maximumFractionDigits: 0,
        }).format(price);
      }

      function handleInputFocus(e) {
        const field = e.target.closest(".field");
        if (field) {
          field.classList.add("field--show-floating-label");
        }
      }

      function handleInputBlur(e) {
        const field = e.target.closest(".field");
        if (field && !e.target.value) {
          field.classList.remove("field--show-floating-label");
        }
      }

      function handleInputChange(e) {
        const field = e.target.closest(".field");
        if (field) {
          if (e.target.value) {
            field.classList.add("field--show-floating-label");
          } else {
            field.classList.remove("field--show-floating-label");
          }
        }
      }

      function checkAddressCompletion() {
        const province = document.getElementById("billingProvince").value;
        const district = document.getElementById("billingDistrict").value;
        const address = document.getElementById("billingAddress").value;

        // Check if essential address fields are filled
        if (province && district && address.trim()) {
          loadShippingMethods();
        } else {
          // Hide shipping methods if address is incomplete
          document.getElementById("shipping-info-alert").style.display =
            "block";
          document.getElementById("shipping-methods").style.display = "none";
          updateShippingFee(0);
        }
      }

      function loadShippingMethods() {
        // Show loading spinner
        const shippingAlert = document.getElementById("shipping-info-alert");
        const shippingMethods = document.getElementById("shipping-methods");
        const loadingSpinner = document.querySelector(".alert--loader");

        shippingAlert.style.display = "none";
        shippingMethods.style.display = "none";

        if (loadingSpinner) {
          loadingSpinner.classList.remove("hide");
        }

        // Simulate loading time
        setTimeout(() => {
          if (loadingSpinner) {
            loadingSpinner.classList.add("hide");
          }

          shippingMethods.style.display = "block";
          updateShippingFee(40000); // 40,000 VND shipping fee

          // Recalculate totals with shipping
          const cartData = localStorage.getItem("sunschool_cart");
          let cart = [];
          try {
            cart = cartData ? JSON.parse(cartData) : [];
          } catch (e) {
            cart = [];
          }
          calculateTotals(cart);
        }, 1500); // 1.5 second loading time
      }

      function updateShippingFee(fee) {
        const shippingPriceElement = document.getElementById("shipping-price");
        if (shippingPriceElement) {
          if (fee > 0) {
            shippingPriceElement.textContent = formatPrice(fee);
          } else {
            shippingPriceElement.textContent = "-";
          }
        }
      }

      // Function removed - province/district/ward handling is now done by vietnam-address.js

      function applyDiscountCode() {
        const discountInput = document.getElementById("reductionCode");
        const discountCode = discountInput.value.trim();

        if (!discountCode) {
          return;
        }

        // Simulate discount code validation
        if (discountCode.toLowerCase() === "discount10") {
          alert("Mã giảm giá đã được áp dụng! Giảm 10%");
          // In a real application, you would recalculate totals here
        } else {
          alert("Mã giảm giá không hợp lệ!");
        }
      }

      function handleCheckoutSubmit(e) {
        e.preventDefault();

        // Validate required fields
        const requiredFields = [
          { id: "email", name: "Email" },
          { id: "billingName", name: "Họ và tên" },
          { id: "billingProvince", name: "Tỉnh thành" },
        ];

        let isValid = true;
        const errors = [];

        requiredFields.forEach((field) => {
          const input = document.getElementById(field.id);
          if (input && !input.value.trim()) {
            isValid = false;
            errors.push(field.name);
            input.style.borderColor = "#dc3545";
          } else if (input) {
            input.style.borderColor = "#d9d9d9";
          }
        });

        // Validate email format
        const emailInput = document.getElementById("email");
        if (emailInput && emailInput.value) {
          const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          if (!emailRegex.test(emailInput.value)) {
            isValid = false;
            errors.push("Email không hợp lệ");
            emailInput.style.borderColor = "#dc3545";
          }
        }

        if (!isValid) {
          alert(
            "Vui lòng điền đầy đủ thông tin bắt buộc:\\n" + errors.join("\\n")
          );
          return;
        }

        // Get cart data
        const cartData = localStorage.getItem("sunschool_cart");
        let cart = [];
        try {
          cart = cartData ? JSON.parse(cartData) : [];
        } catch (e) {
          cart = [];
        }

        if (cart.length === 0) {
          alert("Giỏ hàng đang trống!");
          return;
        }

        // Collect form data
        const formData = new FormData(e.target);

        // Calculate shipping fee
        let shippingFee = 0;
        const shippingPriceElement = document.getElementById("shipping-price");
        if (shippingPriceElement && shippingPriceElement.textContent !== "-") {
          const shippingText = shippingPriceElement.textContent;
          const matches = shippingText.match(/[\d,.]+/g);
          if (matches && matches.length > 0) {
            shippingFee = parseFloat(
              matches[0].replace(/\./g, "").replace(/,/g, "")
            );
          }
        }

        const orderData = {
          customerInfo: {
            email: formData.get("email"),
            name: formData.get("billingName"),
            phone: formData.get("billingPhone"),
            address: formData.get("billingAddress"),
            province: formData.get("billingProvince"),
            district: formData.get("billingDistrict"),
            ward: formData.get("billingWard"),
            // Get full address using vietnam-address.js
            fullAddress: window.vietnamAddressManager.getFullAddress(
              formData.get("billingProvince"),
              formData.get("billingDistrict"),
              formData.get("billingWard"),
              formData.get("billingAddress")
            ),
          },
          items: cart,
          paymentMethod: formData.get("paymentMethod"),
          shippingMethod: formData.get("shippingMethod"),
          shippingFee: shippingFee,
          note: formData.get("note"),
          subtotal: cart.reduce((total, item) => {
            let itemPrice = 0;
            if (item.price && !item.price.includes("Liên hệ")) {
              const priceString = item.price;
              const matches = priceString.match(/[\d,.]+/g);
              if (matches && matches.length > 0) {
                itemPrice = parseFloat(
                  matches[0].replace(/\./g, "").replace(/,/g, "")
                );
              }
            }
            return total + itemPrice * item.quantity;
          }, 0),
          total:
            cart.reduce((total, item) => {
              let itemPrice = 0;
              if (item.price && !item.price.includes("Liên hệ")) {
                const priceString = item.price;
                const matches = priceString.match(/[\d,.]+/g);
                if (matches && matches.length > 0) {
                  itemPrice = parseFloat(
                    matches[0].replace(/\./g, "").replace(/,/g, "")
                  );
                }
              }
              return total + itemPrice * item.quantity;
            }, 0) + shippingFee,
        };

        // Simulate order submission
        const submitBtn = e.target.querySelector(".btn-checkout");
        const originalText = submitBtn.innerHTML;

        submitBtn.innerHTML =
          '<span class="spinner-label">Đang xử lý...</span>';
        submitBtn.disabled = true;

        setTimeout(() => {
          // Save order data to localStorage for invoice page
          localStorage.setItem("lastOrder", JSON.stringify(orderData));

          // Clear cart after successful order
          localStorage.removeItem("sunschool_cart");

          // Redirect to invoice page
          window.location.href = "./HoaDon.html";
        }, 2000);
      }
    </script>
  </body>
</html>
